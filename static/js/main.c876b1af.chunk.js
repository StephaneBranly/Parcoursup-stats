(this["webpackJsonpparcoursup-stats"]=this["webpackJsonpparcoursup-stats"]||[]).push([[0],{303:function(e,t,a){},305:function(e,t,a){},308:function(e,t,a){},327:function(e,t,a){},328:function(e,t,a){},472:function(e,t,a){},473:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),s=a(116),i=a.n(s),r=(a(303),a(71)),o=a.n(r),l=a(120),d=a(37),u=(a(305),a(254)),f=(a(308),a(7)),b=function(){return Object(f.jsx)("div",{className:"pcs-header",children:Object(f.jsx)("h1",{className:"pcs-header-title",children:"\ud83d\udcca Statistiques sur la plateforme"})})},j=(Math.floor,Math.random,a(151)),p=a.n(j),h="https://data.enseignementsup-recherche.gouv.fr/api/records/1.0/search/?dataset=fr-esr-parcoursup",m=function(){var e=Object(l.a)(o.a.mark((function e(t){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=h+'&q=cod_aff_form%3D"'.concat(t,'"'),e.next=4,p.a.get(a);case 4:if(!(n=e.sent).data||1!==n.data.nhits){e.next=7;break}return e.abrupt("return",n.data.records[0].fields);case 7:return e.abrupt("return",{});case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",{});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),_=function(e,t){return void 0!==e[t]?e[t]:"NaN"},x=(a(327),function(e){var t=e.currentSchool;return t?Object(f.jsxs)("div",{className:"pcs-formationinfos-fragment",children:[Object(f.jsx)("h1",{className:"pcs-formationinfos-title",children:"Informations g\xe9n\xe9rales"}),Object(f.jsxs)("div",{className:"pcs-formationinfos-main",children:[Object(f.jsx)("h1",{className:"pcs-schoolname",children:_(t,"fil_lib_voe_acc")}),Object(f.jsx)("p",{children:Object(f.jsxs)("ul",{className:"pcs-stats-ul",children:[Object(f.jsxs)("li",{children:["\ud83c\udfe2 ",_(t,"g_ea_lib_vx")," - ",Object(f.jsx)("i",{children:_(t,"contrat_etab")})]}),Object(f.jsxs)("li",{children:["\ud83d\uddfa ",_(t,"dep_lib")," (",_(t,"dep"),") -"," ",_(t,"region_etab_aff")]})]})})]}),Object(f.jsx)("div",{className:"pcs-formationinfos-stats",children:Object(f.jsxs)("p",{children:[Object(f.jsx)("b",{children:"En 2020 :"}),Object(f.jsxs)("ul",{className:"pcs-stats-ul",children:[Object(f.jsxs)("li",{children:["\ud83c\udf93 ",Object(f.jsx)("b",{children:_(t,"capa_fin")})," places disponibles"]}),Object(f.jsxs)("li",{children:["\ud83d\udcc4 ",Object(f.jsx)("b",{children:_(t,"voe_tot")})," voeux enregistr\xe9s"]})]})]})}),Object(f.jsxs)("div",{className:"pcs-formationinfo-statscard-wrapper",children:[Object(f.jsx)(Z,{count_candidat_boys:_(t,"voe_tot")-_(t,"voe_tot_f"),count_candidat_girls:_(t,"voe_tot_f"),count_accepted_boys:_(t,"acc_tot")-_(t,"acc_tot_f"),count_accepted_girls:_(t,"acc_tot_f"),title:"Proportion de candidates / candidats"}),Object(f.jsx)(U,{count_candidates:_(t,"nb_voe_pp"),count_classed:_(t,"nb_cla_pp"),count_proposition_received:_(t,"prop_tot"),count_proposition_accepted:_(t,"acc_tot"),title:"S\xe9lectivit\xe9 de la formation"}),Object(f.jsx)(X,{count_tb:_(t,"acc_tb"),count_b:_(t,"acc_b"),count_ab:_(t,"acc_ab"),count_sm:_(t,"acc_sansmention"),count_nr:_(t,"acc_mention_nonrenseignee"),title:"Mentions des n\xe9o-bachelier.e.s"})]})]}):Object(f.jsxs)("div",{className:"pcs-formationinfos-fragment",children:[Object(f.jsx)("h1",{className:"pcs-formationinfos-title",children:"Informations g\xe9n\xe9rales"}),Object(f.jsx)("div",{className:"pcs-formationinfos-main",children:Object(f.jsx)("h1",{className:"pcs-schoolname",children:"Selectionnez une formation"})})]})}),v=a(279),O=(a(328),a(273)),g=a(78),y=a(166),N=a(257),w=a(100),S=a(13),k=a(274),A=a(82),P=a(131),E=a(92),F=a(198),K=a(278),z=a(108),D=a.p+"static/media/marker.7a162fbb.svg",R=function(e){var t={};return new k.a({source:e,style:function(e){var a=e.get("features").length,n=t[a];if(!n||1===a){if(1===a){var c=e.get("features")[0].getProperties().g_ea_lib_vx;n=[new z.b({image:new K.a({src:D,color:"#e63946",anchor:[.5,1],scale:.5}),text:new F.a({text:c,offsetY:10})})]}else n=[new z.b({image:new P.a({radius:15,stroke:new E.a({color:"#e63946"}),fill:new A.a({color:"#1d3557"})}),text:new F.a({text:a.toString(),fill:new A.a({color:"#fff"})})})];t[a]=n}return n}})},q=a(477),T=function(e){return new q.a({distance:40,minDistance:20,source:e})},C=a(277),I=a(275),L=function(){return new C.a({maxZoom:19,source:new I.a({url:"https://cartodb-basemaps-a.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"})})},M=function(e){var t=Object(n.useState)(),a=Object(d.a)(t,2),c=a[0],s=a[1],i=Object(n.useState)(),r=Object(d.a)(i,2),o=r[0],l=r[1],u=Object(n.useRef)();return Object(n.useEffect)((function(){var t,a=new y.a,n=new O.a({target:null!==(t=u.current)&&void 0!==t?t:void 0,layers:[L(),R(T(a))],view:new g.a({projection:"EPSG:3857",center:[0,0],zoom:2}),controls:[]});n.addEventListener("singleclick",(function(t){return function(e,t,a){var n=[];if(t.forEachFeatureAtPixel(e.pixel,(function(e){return n.push(e)})),console.log(n),1===n.length&&1===n[0].getProperties().features.length){var c=n[0].getProperties().features[0].getProperties();console.log(c),c.cod_aff_form&&a(c.cod_aff_form)}}(t,n,e.loadSchool)})),s(n),l(a)}),[]),Object(n.useEffect)((function(){if(o&&0!==e.schoolsData.length){var t=e.schoolsData.filter((function(e){return void 0!==e.g_olocalisation_des_formations})).map((function(e){var t=e.g_olocalisation_des_formations,a=new N.a({geometry:new w.a(Object(S.o)(t.reverse(),"EPSG:4326","EPSG:3857"))});return a.setProperties(Object(v.a)({},e)),a}));t&&(o.clear(),o.addFeatures(t),c&&c.getView().fit(o.getExtent(),{padding:[100,100,100,100]}))}}),[e.schoolsData]),Object(f.jsxs)("div",{className:"pcs-map-fragment",children:[Object(f.jsx)("h1",{className:"pcs-map-title",children:"Carte des formations"}),Object(f.jsx)("div",{className:"pcs-map-container",children:Object(f.jsx)("div",{ref:u,className:"pcs-map"})})]})},B=a(478),G=a(484),J=a(269),V=a(163),Y=a(129),Z=function(e){var t=[{key:"Nombre de candidates",value:e.count_candidat_girls,fill:"#e63946"},{key:"Nombre de candidats",value:e.count_candidat_boys,fill:"#a8dadc"}],a=[{key:"Nombre d'accept\xe9es",value:e.count_accepted_girls,fill:"#6b6fdb"},{key:"Nombre d'accept\xe9s",value:e.count_accepted_boys,fill:"#76d169"}],n=(e.count_candidat_girls/(e.count_candidat_girls+e.count_candidat_boys)*100).toFixed(0),c=(e.count_accepted_girls/(e.count_accepted_girls+e.count_accepted_boys)*100).toFixed(0),s="Soit ".concat(n,"% de candidates et ").concat(c,"% ayant accept\xe9 d\xe9finitivement la proposition");return Object(f.jsx)(W,{title:e.title,description:s,children:Object(f.jsx)(B.a,{width:"100%",height:250,children:Object(f.jsxs)(G.a,{children:[Object(f.jsx)(J.a,{data:t,startAngle:0,endAngle:180,isAnimationActive:!1,dataKey:"value",nameKey:"key",cx:"50%",cy:"100%",innerRadius:80,outerRadius:120,children:Object(f.jsx)(V.a,{position:"insideTop",fill:"#000",stroke:"none",dataKey:"value"})}),Object(f.jsx)(J.a,{data:a,isAnimationActive:!1,startAngle:0,endAngle:180,dataKey:"value",nameKey:"key",cx:"50%",cy:"100%",innerRadius:20,outerRadius:60,children:Object(f.jsx)(V.a,{position:"inside",fill:"#000",stroke:"none",dataKey:"value"})}),Object(f.jsx)(Y.a,{iconSize:10,layout:"horizontal",verticalAlign:"bottom",align:"center"})]})})})},H=a(482),Q=a(280),U=function(e){var t=e.title,a=e.count_classed,n=e.count_proposition_accepted,c=e.count_proposition_received,s=e.count_candidates,i=function(e,t){return"".concat(e," ").concat(t," (").concat((e/s*100).toFixed(0),"%)")},r=[{name:"Nombre de candidats",value:s,fill:"#e63946",label:i(s,"candidat.e.s")},{name:"Nombre de candidats class\xe9s",value:a,fill:"#a8dadc",label:i(a,"class\xe9.e.s")},{name:"Nombre de candidats ayant recu une proposition",value:c,fill:"#457b9d",label:i(c,"re\xe7u.e.s")},{name:"Nombre de candidats ayant accept\xe9 la proposition",value:n,fill:"#1d3557",label:i(n,"accept\xe9.e.s")}];return Object(f.jsx)(W,{title:t,children:Object(f.jsx)(B.a,{width:"100%",height:250,children:Object(f.jsx)(H.a,{children:Object(f.jsx)(Q.a,{dataKey:"value",data:r,isAnimationActive:!1,children:Object(f.jsx)(V.a,{position:"insideTopLeft",offset:10,fill:"#000",stroke:"none",dataKey:"label"})})})})})},W=(a(472),function(e){var t=e.children,a=e.title,n=e.description;return Object(f.jsxs)("div",{className:"pcs-statscard",children:[Object(f.jsx)("h1",{className:"pcs-statscard-title",children:a}),Object(f.jsxs)("div",{className:"pcs-statscard-content",children:[t,n&&Object(f.jsx)("p",{className:"pcs-statscard-description",children:n})]})]})}),X=function(e){var t=e.title,a=e.count_ab,n=e.count_b,c=e.count_nr,s=e.count_sm,i=e.count_tb,r=a+n+c+s+i,o=function(e){return e?"".concat(e," (").concat((e/r*100).toFixed(0),"%)"):""},l=[{name:"Tr\xe8s bien",value:i,fill:"#e63946",label:o(i)},{name:"Bien",value:n,fill:"#a8dadc",label:o(n)},{name:"Assez bien",value:a,fill:"#457b9d",label:o(a)},{name:"Sans mention",value:s,fill:"#1d3557",label:o(s)},{name:"Non r\xe9f\xe9renc\xe9",value:c,fill:"#2e2e2e",label:o(c)}];return Object(f.jsx)(W,{title:t,children:Object(f.jsx)(B.a,{width:"100%",height:250,children:Object(f.jsxs)(G.a,{children:[Object(f.jsx)(J.a,{data:l,cx:"50%",cy:"50%",isAnimationActive:!1,outerRadius:80,dataKey:"value",label:!0}),Object(f.jsx)(Y.a,{iconSize:10,layout:"horizontal",verticalAlign:"bottom",align:"center"})]})})})};var $=function(){var e=Object(n.useState)(),t=Object(d.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)([]),i=Object(d.a)(s,2),r=i[0],j=i[1],_=function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(t);case 2:a=e.sent,console.log(a),c(a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){v()}),[]);var v=function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=!1,a=0;case 3:if(t){e.next=12;break}return n=h+"&q=&rows=1000&start=".concat(a,"&fields=cod_aff_form,g_ea_lib_vx,g_olocalisation_des_formations"),e.next=7,p.a.get(n);case 7:(c=e.sent).data&&(a+=c.data.records.length,j(r.concat(c.data.records.map((function(e){return e.fields}))))),t=!0,e.next=3;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("error");case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){v()}),[]),Object(f.jsxs)("section",{children:[Object(f.jsxs)(u.a,{children:[Object(f.jsx)("title",{children:"Parcoursup - Statistiques"}),Object(f.jsx)("meta",{name:"description",content:"Visualiseur des donn\xe9es publiques de Parcoursup"})]}),Object(f.jsx)(b,{}),Object(f.jsxs)("section",{className:"pcs-main-section",children:[Object(f.jsx)(M,{schoolsData:r,dataAttribution:"",loadSchool:_}),Object(f.jsx)(x,{currentSchool:a})]})]})},ee=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,485)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,s=t.getLCP,i=t.getTTFB;a(e),n(e),c(e),s(e),i(e)}))};i.a.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsx)($,{})}),document.getElementById("root")),ee()}},[[473,1,2]]]);
//# sourceMappingURL=main.c876b1af.chunk.js.map