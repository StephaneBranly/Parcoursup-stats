(this["webpackJsonpparcoursup-stats"]=this["webpackJsonpparcoursup-stats"]||[]).push([[0],{279:function(e,t,a){},281:function(e,t,a){},284:function(e,t,a){},303:function(e,t,a){},304:function(e,t,a){},435:function(e,t,a){"use strict";a.r(t);var c=a(0),n=a.n(c),r=a(113),s=a.n(r),o=(a(279),a(64)),i=a.n(o),l=a(95),u=a(34),d=(a(281),a(228)),f=(a(284),a(20)),b=function(){return Object(f.jsx)("div",{className:"pcs-header",children:Object(f.jsx)("h1",{className:"pcs-header-title",children:"\ud83d\udcca Statistiques sur la plateforme"})})},j=(Math.floor,Math.random,a(141)),p=a.n(j),_="https://data.enseignementsup-recherche.gouv.fr/api/records/1.0/search/?dataset=fr-esr-parcoursup",h=function(){var e=Object(l.a)(i.a.mark((function e(t){var a,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=_+'&q=cod_aff_form%3D"'.concat(t,'"'),e.next=4,p.a.get(a);case 4:if(!(c=e.sent).data||1!==c.data.nhits){e.next=7;break}return e.abrupt("return",c.data.records[0].fields);case 7:return e.abrupt("return",{});case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",{});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),m=(a(303),function(){var e=Object(c.useState)({}),t=Object(u.a)(e,2),a=t[0],n=t[1],r=function(){var e=Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("55");case 2:t=e.sent,console.log(t),n(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){r()}),[]);var s=function(e){return a[e]?a[e]:"NaN"};return Object(f.jsxs)("div",{className:"pcs-formationinfos-fragment",children:[Object(f.jsx)("h1",{className:"pcs-formationinfos-title",children:"Informations sur la formation"}),Object(f.jsxs)("div",{className:"pcs-formationinfos",children:[Object(f.jsx)("h1",{className:"pcs-schoolname",children:s("fil_lib_voe_acc")}),Object(f.jsxs)("p",{children:["\ud83c\udfe2 ",s("g_ea_lib_vx")," - ",s("contrat_etab"),Object(f.jsx)("br",{}),"\ud83d\uddfa ",s("dep_lib")," (",s("dep"),") -"," ",s("region_etab_aff")]})]}),Object(f.jsx)("div",{className:"pcs-formationinfos-stats",children:Object(f.jsxs)("p",{children:["En 2020 :",Object(f.jsx)("br",{}),s("voe_tot")," voeux enregistr\xe9s pour cette formation"]})}),Object(f.jsx)(Y,{count_candidat_boys:s("voe_tot")-s("voe_tot_f"),count_candidat_girls:s("voe_tot_f"),count_accepted_boys:s("acc_tot")-s("acc_tot_f"),count_accepted_girls:s("acc_tot_f"),title:"Proportion de candidates / candidats"})]})}),x=a(255),v=(a(304),a(249)),O=a(75),g=a(154),w=a(231),y=a(98),N=a(11),k=a(250),S=a(80),E=a(125),P=a(92),D=a(177),F=a(254),A=a(105),q=a.p+"static/media/marker.7a162fbb.svg",R=function(e){var t={};return new k.a({source:e,style:function(e){var a=e.get("features").length,c=t[a];if(!c||1===a){if(1===a){var n=e.get("features")[0].getProperties().g_ea_lib_vx;c=[new A.b({image:new F.a({src:q,color:"#e63946",anchor:[.5,1],scale:.5}),text:new D.a({text:n,offsetY:10})})]}else c=[new A.b({image:new E.a({radius:15,stroke:new P.a({color:"#e63946"}),fill:new S.a({color:"#1d3557"})}),text:new D.a({text:a.toString(),fill:new S.a({color:"#fff"})})})];t[a]=c}return c}})},z=a(440),C=function(e){return new z.a({distance:40,minDistance:20,source:e})},K=a(253),G=a(251),I=function(){return new K.a({maxZoom:19,source:new G.a({url:"https://cartodb-basemaps-a.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"})})},M=function(e){var t=Object(c.useState)(),a=Object(u.a)(t,2),n=a[0],r=a[1],s=Object(c.useState)(),o=Object(u.a)(s,2),i=o[0],l=o[1],d=Object(c.useRef)();return Object(c.useEffect)((function(){var e,t=new g.a,a=new v.a({target:null!==(e=d.current)&&void 0!==e?e:void 0,layers:[I(),R(C(t))],view:new O.a({projection:"EPSG:3857",center:[0,0],zoom:2}),controls:[]});r(a),l(t)}),[]),Object(c.useEffect)((function(){if(i&&0!==e.schoolsData.length){var t=e.schoolsData.filter((function(e){return void 0!==e.g_olocalisation_des_formations})).map((function(e){var t=e.g_olocalisation_des_formations,a=new w.a({geometry:new y.a(Object(N.o)(t.reverse(),"EPSG:4326","EPSG:3857"))});return a.setProperties(Object(x.a)({},e)),a}));t&&(i.clear(),i.addFeatures(t),n&&n.getView().fit(i.getExtent(),{padding:[100,100,100,100]}))}}),[e.schoolsData]),Object(f.jsxs)("div",{className:"pcs-map-fragment",children:[Object(f.jsx)("h1",{className:"pcs-map-title",children:"Carte des formations"}),Object(f.jsx)("div",{className:"pcs-map-container",children:Object(f.jsx)("div",{ref:d,className:"pcs-map"})})]})},B=a(441),J=a(446),L=a(256),T=a(246),V=a(123),Y=function(e){var t=[{key:"Nombre de candidates",value:e.count_candidat_girls,color:"#e29578"},{key:"Nombre de candidats",value:e.count_candidat_boys,color:"#006d77"}],a=[{key:"Nombre d'accept\xe9es",value:e.count_accepted_girls,color:"#e27890"},{key:"Nombre d'accept\xe9s",value:e.count_accepted_boys,color:"#b7f0c6"}],c=(e.count_candidat_girls/(e.count_candidat_girls+e.count_candidat_boys)*100).toFixed(0),n=(e.count_accepted_girls/(e.count_accepted_girls+e.count_accepted_boys)*100).toFixed(0);return Object(f.jsxs)("div",{children:[Object(f.jsx)("h1",{children:e.title}),Object(f.jsx)(B.a,{width:"100%",height:250,children:Object(f.jsxs)(J.a,{children:[Object(f.jsx)(L.a,{data:t,label:!0,startAngle:0,endAngle:180,dataKey:"value",nameKey:"key",cx:"50%",cy:"100%",innerRadius:80,outerRadius:120,fill:"#8884d8",children:t.map((function(e,t){return Object(f.jsx)(T.a,{fill:e.color},"cell-".concat(t))}))}),Object(f.jsx)(L.a,{data:a,label:!0,startAngle:0,endAngle:180,dataKey:"value",nameKey:"key",cx:"50%",cy:"100%",innerRadius:20,outerRadius:60,fill:"#8884d8",children:a.map((function(e,t){return Object(f.jsx)(T.a,{fill:e.color},"cell-".concat(t))}))}),Object(f.jsx)(V.a,{iconSize:10,layout:"horizontal",verticalAlign:"bottom",align:"center"})]})}),Object(f.jsxs)("p",{children:["Soit ",c,"% de candidates et ",n,"% de filles ayant accept\xe9 le voeu "]})]})};var Z=function(){var e=Object(c.useState)(),t=Object(u.a)(e,2),a=(t[0],t[1],Object(c.useState)([])),n=Object(u.a)(a,2),r=n[0],s=n[1],o=function(){var e=Object(l.a)(i.a.mark((function e(){var t,a,c,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=!1,a=0;case 3:if(t){e.next=12;break}return c=_+"&q=&rows=1000&start=".concat(a,"&fields=cod_aff_form,g_ea_lib_vx,g_olocalisation_des_formations"),e.next=7,p.a.get(c);case 7:(n=e.sent).data&&(a+=n.data.records.length,s(r.concat(n.data.records.map((function(e){return e.fields}))))),t=!0,e.next=3;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("error");case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){o()}),[]),Object(f.jsxs)("section",{children:[Object(f.jsxs)(d.a,{children:[Object(f.jsx)("title",{children:"Parcoursup - Statistiques"}),Object(f.jsx)("meta",{name:"description",content:"Visualiseur des donn\xe9es publiques de Parcoursup"})]}),Object(f.jsx)(b,{}),Object(f.jsxs)("section",{className:"pcs-main-section",children:[Object(f.jsx)(M,{schoolsData:r,dataAttribution:""}),Object(f.jsx)(m,{})]})]})},H=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,447)).then((function(t){var a=t.getCLS,c=t.getFID,n=t.getFCP,r=t.getLCP,s=t.getTTFB;a(e),c(e),n(e),r(e),s(e)}))};s.a.render(Object(f.jsx)(n.a.StrictMode,{children:Object(f.jsx)(Z,{})}),document.getElementById("root")),H()}},[[435,1,2]]]);
//# sourceMappingURL=main.0cdc28e4.chunk.js.map